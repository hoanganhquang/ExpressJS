{"mappings":"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","sources":["public/js/index.js","public/js/login.js","public/js/alert.js","public/js/updateSetting.js","public/js/stripe.js"],"sourcesContent":["import { login, logout } from \"./login.js\";\r\nimport { updateMe } from \"./updateSetting.js\";\r\nimport { bookTour } from \"./stripe.js\";\r\n\r\nconst loginForm = document.querySelector(\".form--login\");\r\nconst formDataUpdate = document.querySelector(\".form-user-data\");\r\nconst formPasswordUpdate = document.querySelector(\".form-user-password\");\r\nconst logoutBtn = document.querySelector(\".nav__el--logout\");\r\nconst bookBtn = document.getElementById(\"book-tour\");\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener(\"submit\", (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById(\"email\").value;\r\n    const password = document.getElementById(\"password\").value;\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (logoutBtn) {\r\n  logoutBtn.addEventListener(\"click\", logout);\r\n}\r\n\r\nif (formDataUpdate) {\r\n  formDataUpdate.addEventListener(\"submit\", (e) => {\r\n    e.preventDefault();\r\n    const form = new FormData();\r\n    form.append(\"name\", document.getElementById(\"name\").value);\r\n    form.append(\"email\", document.getElementById(\"email\").value);\r\n    form.append(\"photo\", document.getElementById(\"photo\").files[0]);\r\n\r\n    updateMe(form, \"data\");\r\n  });\r\n}\r\n\r\nif (formPasswordUpdate) {\r\n  formPasswordUpdate.addEventListener(\"submit\", async (e) => {\r\n    e.preventDefault();\r\n    document.querySelector(\".btn--save-password\").textContent = \"Updating...\";\r\n\r\n    const currentPassword = document.getElementById(\"password-current\").value;\r\n    const newPassword = document.getElementById(\"password\").value;\r\n    await updateMe({ currentPassword, newPassword }, \"password\");\r\n\r\n    document.querySelector(\".btn--save-password\").textContent = \"Save password\";\r\n  });\r\n}\r\n\r\nif (bookBtn) {\r\n  bookBtn.addEventListener(\"click\", (e) => {\r\n    e.target.textContent = \"Processing...\";\r\n    const { tourId } = e.target.dataset;\r\n    bookTour(tourId);\r\n  });\r\n}\r\n","import { showAlert } from \"./alert.js\";\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: \"POST\",\r\n      url: \"/api/v1/users/login\",\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === \"success\") {\r\n      showAlert(\"success\", \"Logged in\");\r\n      window.setTimeout(() => {\r\n        location.assign(\"/\");\r\n      }, 1500);\r\n    }\r\n  } catch (error) {\r\n    showAlert(\"error\", error.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: \"GET\",\r\n      url: \"/api/v1/users/logout\",\r\n    });\r\n\r\n    if (res.data.status === \"success\") {\r\n      location.reload(true);\r\n    }\r\n  } catch (error) {\r\n    showAlert(\"error\", \"Error logging out!\");\r\n  }\r\n};\r\n","export const hideAlert = () => {\r\n  const el = document.querySelector(\".alert\");\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\nexport const showAlert = (type, msg) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector(\"body\").insertAdjacentHTML(\"afterbegin\", markup);\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n","import { showAlert } from \"./alert.js\";\r\n\r\nexport const updateMe = async (data, type) => {\r\n  try {\r\n    const url =\r\n      type === \"password\"\r\n        ? \"/api/v1/users/updatePassword\"\r\n        : \"/api/v1/users/updateMe\";\r\n\r\n    const res = await axios({\r\n      method: \"POST\",\r\n      url,\r\n      data,\r\n    });\r\n    console.log(res);\r\n    if (res.data.status === \"success\") {\r\n      showAlert(\"success\", \"Updated\");\r\n      window.setTimeout(() => {\r\n        location.reload();\r\n      }, 1200);\r\n    }\r\n  } catch (error) {\r\n    showAlert(\"error\", \"update fail\");\r\n  }\r\n};\r\n","import { showAlert } from \"./alert\";\r\n\r\nconst stripe = Stripe(\r\n  \"pk_test_51Js1lgASo0bi48TADOMmUH6FkNLRvnBnMrzRSSEqCZSOeNsbwrJ9Hka8ORb0KTxHKNHFslDol3SJcrzHG9vdBdeq00LfjQ43C5\"\r\n);\r\n\r\nexport const bookTour = async (tourId) => {\r\n  try {\r\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\r\n\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch (error) {\r\n    showAlert(\"error\", error);\r\n  }\r\n};\r\n"],"names":[],"version":3,"file":"bundle.js.map"}